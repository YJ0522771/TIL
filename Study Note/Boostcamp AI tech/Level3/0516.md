# 05/16

### 할 일

* 1-2강 MLOps 개론
* 1-3강 Model Serving
* 1-4강 머신러닝 프로젝트 라이프 사이클



### 피어세션

* label -1은 무엇인가.
* 항목별로 따로 학습.
  * 적절한 augmentation이 다를 수 있다.

* 부위별로 나누어 평가해야 하는가?
  * 나눈다면 어떻게 나눌 것인가?

* 부위별로 나누어 담당, 항목별, 점수별 이미지 정리해보기.
* timm을 사용하는 방향으로.




### 공부한 내용

#### MLOps 개론

* research 프로세스
  * 문제 정의 - EDA - Feature engineering - Train - Predict
* production 프로세스
  * 문제 정의 - EDA - Feature engineering - Train - Predict - **Deploy**



* 실제 서비스 환경에서는 outlier를 제외하기 힘들다.
* research 환경과 production 환경에서 모델의 성능이 다를 수 있음.



###### MLOps란?

* 머신러닝 모델을 운영하면서 반복적으로 필요한 업무를 자동화시키는 과정.
* 머신러닝 엔지니어링 + 데이터 엔지니어링 + 클라우드 + 인프라
* 모델링에 집중할 수 있도록 관련 인프라를 만들고, 자동으로 운영되도록 만든다.



###### Research와 Production

![image-20220516134600518](0516.assets/image-20220516134600518.png)



###### Infra

* 클라우드 : AWS, GCP, Azure, NCP 등.
* 온 프레미스 : 회사나 대학원 전산실에 서버를 직접 설치.



* 대표 라이브러리 : MLflow



---



####  Model Serving

###### Serving

* production 환경에서 모델을 사용할 수 있도록 배포.



* Online Serving
* Batch Serving



###### API (Application Programming Interface)

* 운영체제나 프로그래밍 언어가 제공하는 기능을 제어할 수 있게 만든 인터페이스.



###### Online Serving

![image-20220516195513627](0516.assets/image-20220516195513627.png)

* 전처리 서버와 모델 서버를 나눌 수도 있다.
* 서비스 서버와 ML 서버를 별도로 운영할 수도 있다.

* 방법
  * 직접 API 웹 서버 개발
    * Flask, FastAPI 등
  * 클라우드 서비스 활용
    * 다양한 부분을 직접 구축하지 않아도 됨.
    * 사용자 관점에서는 학습 코드만 제공하면 API 서버가 만들어짐.
    * 익숙해야 잘 사용할 수 있음.
    * 비용이 든다.
  * serving 라이브러리 활용

* 재현 가능한 코드.
* latency 최소화.
* 결과에 대한 보정이 필요할 수도 있음을 고려.



###### Batch Serving

![image-20220516200701916](0516.assets/image-20220516200701916.png)

* 특정 시간 단위로 실행.
* online serving 보다 구현이 간단함.
* latency에 대한 제약이 적음.
* cold start 
  * 실시간으로 활용할 수 없음.
  * 오늘 새로 생긴 컨텐츠는 추천할 수 없다.



---



#### 머신러닝 프로젝트 라이프 사이클

##### 머신러닝 프로젝트 Flow

###### **1. 문제 정의**

1. 특정 현상을 파악하고 문제를 정의.
2. 풀려고 하는 문제가 명확할 필요가 있음.
3. 현상을 발견하고 상황을 파악해야 함.

###### **2. 구체적인 문제 정의**

1. 인터뷰 등을 통해 구체적인 문제가 무엇인 지 파악.
2. 문제를 쪼개서 파악.
3. 알고리즘 접근이 항상 최상의 방법은 아니라는 것을 생각. (시간의 제약 등) 해결 방식은 다양하다.
4. 점진적으로 실행하기.

###### **3. 프로젝트 설계**

1. 머신러닝으로 해결하는 것이 타당한 문제인지 확인.
   1. 필요한 데이터 파악.
   2. 기존 모델이 있는지 파악.
   3. 고려할 점
      1. 학습할 수 있는 패턴이 있는가?
      2. 학습을 위한 목적 함수를 만들 수 있는가?
   4. 머신러닝이 사용되면 좋은 경우
      1. 패턴이 복잡. - 단순한 패턴인 경우 굳이 머신러닝을 사용할 필요가 없을 수 있다.
      2. 데이터 존재 여부.
      3. 반복적 (패턴)으로 실행하는 경우.
   5. 머신러닝이 사용되면 좋지 않는 경우
      1. 비윤리적 문제.
      2. 간단히 해결 가능.
      3. 좋은 데이터를 얻기 어려운 경우.
      4. 예측 오류가 치명적인 경우.
      5. 모든 결정에 대한 설명이 필요한 경우.
      6. 비용 효율적이지 않은 경우.
2. 목표 설정, 지표 설정.
   1. goal : 프로젝트의 큰 목적.
   2. objectives : 세부 단계 목표.
   3. 목표를 설정하며 데이터를 확인해야함. (label 등이 목적에 맞는지)
   4. objective가 여러 개인 경우 분리하는 것이 좋음.
      1. 하나의 objective를 최적화 하는 것이 더 쉬움.
      2. objective 별로 유지보수 일정이 다를 수 있음.
3. 제약 조건 파악.
   1. 일정, 예산, 관련된 사람 (영향을 받는 사람)
   2. 개인정보 보호, 기술적 제약
   3. 윤리적 이슈
   4. 성능
      1. baseline
      2. threshold
      3. performance trade-off
      4. 해석 가능 여부
      5. confidence measurement
4. 평가 방법 설정.
5. 어떤 비즈니스 가치를 줄 수 있는지 고려.